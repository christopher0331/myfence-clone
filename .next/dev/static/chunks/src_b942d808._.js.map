{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/repos/myfence-clone/src/integrations/supabase/client.ts"],"sourcesContent":["// This file is automatically generated. Do not edit it directly.\nimport { createClient } from '@supabase/supabase-js';\nimport type { Database } from './types';\n\nconst SUPABASE_URL = \"https://tlsayvwmcqnmdoairbeb.supabase.co\";\nconst SUPABASE_PUBLISHABLE_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRsc2F5dndtY3FubWRvYWlyYmViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzODM4NDIsImV4cCI6MjA3MDk1OTg0Mn0.mgcamhsEcu2xSFz5LOxCjcWWLuvt53iySmXpwp-ytG8\";\n\n// Import the supabase client like this:\n// import { supabase } from \"@/integrations/supabase/client\";\n\nconst isBrowser = typeof window !== \"undefined\";\n\nexport const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY, {\n  auth: {\n    // Use localStorage only in the browser; on the server Supabase will fall back to in-memory\n    storage: isBrowser ? window.localStorage : undefined,\n    persistSession: isBrowser,\n    autoRefreshToken: isBrowser,\n  },\n});"],"names":[],"mappings":"AAAA,iEAAiE;;;;;AACjE;;AAGA,MAAM,eAAe;AACrB,MAAM,2BAA2B;AAEjC,wCAAwC;AACxC,6DAA6D;AAE7D,MAAM,YAAY,+CAAkB;AAE7B,MAAM,WAAW,IAAA,mMAAY,EAAW,cAAc,0BAA0B;IACrF,MAAM;QACJ,2FAA2F;QAC3F,SAAS,uCAAY,OAAO,YAAY,GAAG;QAC3C,gBAAgB;QAChB,kBAAkB;IACpB;AACF"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/repos/myfence-clone/src/components/GoogleBusinessMap.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Loader2, MapPin, Phone, Star } from \"lucide-react\";\nimport { supabase } from \"@/integrations/supabase/client\";\n\ndeclare global {\n  interface Window {\n    google: any;\n  }\n}\n\ninterface GoogleBusinessMapProps {\n  placeId?: string;\n  city?: string;\n  state?: string;\n  radiusMiles: number;\n  className?: string;\n  showBusinessInfo?: boolean;\n  zoom?: number;\n}\n\ninterface BusinessData {\n  displayName?: { text: string };\n  formattedAddress?: string;\n  location?: { latitude: number; longitude: number };\n  rating?: number;\n  userRatingCount?: number;\n  nationalPhoneNumber?: string;\n  websiteUri?: string;\n}\n\nconst GoogleBusinessMap = ({ placeId, city, state, radiusMiles, className = \"\", showBusinessInfo = true, zoom: customZoom }: GoogleBusinessMapProps) => {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const [businessData, setBusinessData] = useState<BusinessData | null>(null);\n  const [cityLocation, setCityLocation] = useState<{ lat: number; lng: number } | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchBusinessData = async () => {\n      if (!placeId) {\n        // If no placeId, we'll just use city geocoding\n        setBusinessData(null);\n        setLoading(false);\n        return;\n      }\n      \n      try {\n        setLoading(true);\n        const { data, error } = await supabase.functions.invoke('fetch-google-business', {\n          body: { placeId }\n        });\n\n        if (error) throw error;\n        setBusinessData(data);\n      } catch (err) {\n        console.error('Error fetching business data:', err);\n        setError('Failed to load business information');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchBusinessData();\n  }, [placeId]);\n\n  useEffect(() => {\n    if (!mapRef.current) return;\n    if (!businessData?.location && !cityLocation && !city) return;\n    if (loading) return; // Don't init map while still loading\n\n    const initMap = async () => {\n      // Determine center coordinates\n      let center: { lat: number; lng: number };\n      \n      if (city && state && !cityLocation) {\n        // Geocode the city to get coordinates\n        const geocoder = new window.google.maps.Geocoder();\n        try {\n          const result = await geocoder.geocode({ address: `${city}, ${state}` });\n          if (result.results && result.results[0]) {\n            const location = result.results[0].geometry.location;\n            center = { lat: location.lat(), lng: location.lng() };\n            setCityLocation(center);\n          } else {\n            throw new Error('City not found');\n          }\n        } catch (err) {\n          console.error('Geocoding error:', err);\n          setError('Failed to locate city');\n          return;\n        }\n      } else if (cityLocation) {\n        center = cityLocation;\n      } else if (businessData?.location) {\n        const { latitude, longitude } = businessData.location;\n        center = { lat: latitude, lng: longitude };\n      } else {\n        return;\n      }\n\n      // Initialize map with appropriate zoom based on radius and device\n      const getZoomLevel = (miles: number) => {\n        const isMobile = window.innerWidth < 768;\n        if (miles >= 50) return isMobile ? 7 : 8;\n        if (miles >= 20) return isMobile ? 8 : 9;\n        return isMobile ? 9 : 11;\n      };\n\n      const map = new window.google.maps.Map(mapRef.current!, {\n        center,\n        zoom: customZoom || getZoomLevel(radiusMiles),\n        styles: [\n          {\n            featureType: \"poi\",\n            elementType: \"labels\",\n            stylers: [{ visibility: \"off\" }]\n          }\n        ]\n      });\n\n      // Add marker for location\n      new window.google.maps.Marker({\n        position: center,\n        map,\n        title: city ? `${city}, ${state}` : (businessData?.displayName?.text || \"MyFence.com\"),\n        icon: {\n          path: window.google.maps.SymbolPath.CIRCLE,\n          scale: 10,\n          fillColor: \"#FF6B35\",\n          fillOpacity: 1,\n          strokeColor: \"#fff\",\n          strokeWeight: 2,\n        }\n      });\n\n      // Add service area circle\n      new window.google.maps.Circle({\n        strokeColor: \"#FF6B35\",\n        strokeOpacity: 0.8,\n        strokeWeight: 2,\n        fillColor: \"#FF6B35\",\n        fillOpacity: 0.15,\n        map,\n        center,\n        radius: radiusMiles * 1609.34, // Convert miles to meters\n      });\n    };\n\n    // Load Google Maps script if not already loaded\n    const loadGoogleMaps = async () => {\n      if (!(window.google && window.google.maps)) {\n        try {\n          const { data } = await supabase.functions.invoke('get-maps-key');\n          const apiKey = data?.key;\n          \n          if (!apiKey) {\n            throw new Error('Failed to get Maps API key');\n          }\n\n          const script = document.createElement('script');\n          script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}`;\n          script.async = true;\n          script.defer = true;\n          script.onload = () => initMap();\n          script.onerror = () => {\n            console.error('Google Maps JS failed to load');\n            setError('Failed to load map');\n          };\n          document.head.appendChild(script);\n        } catch (err) {\n          console.error('Error loading Google Maps:', err);\n          setError('Failed to load map');\n        }\n      } else {\n        initMap();\n      }\n    };\n\n    loadGoogleMaps();\n  }, [businessData, cityLocation, city, state, radiusMiles, loading]);\n\n  if (loading) {\n    return (\n      <Card className={className}>\n        <CardContent className=\"p-8 flex items-center justify-center\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error || (placeId && !businessData)) {\n    return (\n      <Card className={className}>\n        <CardContent className=\"p-8 text-center text-muted-foreground\">\n          {error || \"Unable to load map\"}\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className={className}>\n      <Card>\n        <CardContent className=\"p-0 relative\">\n          {/* Business Info Overlay - only show if we have business data and showBusinessInfo is true */}\n          {showBusinessInfo && businessData && (\n            <div className=\"absolute top-4 left-4 z-10 bg-white rounded-lg shadow-lg max-w-[280px]\">\n              <div className=\"p-3 relative\">\n                <div className=\"flex items-start justify-between gap-2 mb-1\">\n                  <h3 className=\"font-semibold text-sm leading-tight truncate flex-1\">\n                    {businessData.displayName?.text || \"MyFence.com\"}\n                  </h3>\n                  {businessData.location && (\n                    <a\n                      href={`https://www.google.com/maps/dir/?api=1&destination=${businessData.location.latitude},${businessData.location.longitude}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"text-xs text-blue-600 hover:underline whitespace-nowrap flex-shrink-0\"\n                    >\n                      Directions\n                    </a>\n                  )}\n                </div>\n                {businessData.formattedAddress && (\n                  <p className=\"text-xs text-gray-600 mb-2 line-clamp-2\">\n                    {businessData.formattedAddress}\n                  </p>\n                )}\n                {businessData.rating && (\n                  <div className=\"flex items-center gap-1.5 mb-2\">\n                    <span className=\"font-semibold text-sm\">{businessData.rating.toFixed(1)}</span>\n                    <div className=\"flex\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star \n                          key={i} \n                          className=\"h-3 w-3 fill-orange-500 text-orange-500\" \n                        />\n                      ))}\n                    </div>\n                    {businessData.userRatingCount && (\n                      <a \n                        href={businessData.websiteUri || \"#\"}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"text-xs text-blue-600 hover:underline\"\n                      >\n                        {businessData.userRatingCount} reviews\n                      </a>\n                    )}\n                  </div>\n                )}\n                {businessData.location && (\n                  <a\n                    href={`https://www.google.com/maps/search/?api=1&query=${businessData.location.latitude},${businessData.location.longitude}`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-xs text-blue-600 hover:underline\"\n                  >\n                    View larger map\n                  </a>\n                )}\n              </div>\n            </div>\n          )}\n          \n          {/* Map */}\n          <div ref={mapRef} className=\"w-full h-[300px] md:h-[500px] rounded-lg\" />\n          \n          {/* Service Area Info */}\n          <div className=\"p-4 bg-muted/30 text-center text-sm text-muted-foreground\">\n            {city \n              ? `Serving a ${radiusMiles}-mile radius in ${city}, ${state}`\n              : `Serving a ${radiusMiles}-mile radius from our location`\n            }\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default GoogleBusinessMap;\n"],"names":[],"mappings":"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"}}]
}